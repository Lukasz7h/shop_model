{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/luuuk/OneDrive/Pulpit/angular/shop/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./basket.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/router\";\n\nfunction BasketComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"div\");\n    i0.ɵɵelementStart(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"input\", 2, 3);\n    i0.ɵɵlistener(\"input\", function BasketComponent_div_2_Template_input_input_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const e_r1 = restoredCtx.$implicit;\n\n      const _r2 = i0.ɵɵreference(5);\n\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.changeProductCount(e_r1, _r2.value);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"button\", 4);\n    i0.ɵɵlistener(\"click\", function BasketComponent_div_2_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const e_r1 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.deleteFromBasket(e_r1);\n    });\n    i0.ɵɵtext(11, \"Usu\\u0144\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const e_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(e_r1.product.name);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"value\", e_r1.count);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Ilo\\u015B\\u0107: \", e_r1.stuffCount, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Cena za produkt: \", ctx_r0.roundPrice(e_r1.count * e_r1.product.price), \"z\\u0142\");\n  }\n}\n\nexport class BasketComponent {\n  constructor(basketService) {\n    this.basketService = basketService;\n    this.price = 0;\n    this.basket = [];\n    this.priceForAll = 0;\n\n    this.basketIsEmpty = () => this.basket.length === 0;\n  }\n\n  setBasket(e) {\n    this.priceForAll = 0;\n\n    for (let item of e) {\n      let stuff = {\n        count: item[\"productCount\"],\n        product: item[\"product\"]\n      };\n      this.priceForAll += stuff.count * stuff.product['price'];\n      this.basket.push(stuff);\n    }\n\n    ;\n  }\n\n  ngOnInit() {\n    this.basketService.getProducts().subscribe(e => {\n      console.log(e);\n      this.setBasket(e);\n    });\n  }\n\n  deleteFromBasket(e) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const productName = e.product.name;\n      const productType = e.product.type;\n      let deleteFun;\n\n      _this.basketService.removeFromBasket(productName, productType).subscribe(e => {\n        if (e[\"delete\"] === true) {\n          _this.basketService.getProducts().subscribe(e => {\n            _this.basket = [];\n\n            _this.setBasket(e);\n          });\n        }\n\n        ;\n      });\n    })();\n  }\n\n  changeProductCount(e, count) {\n    if (e.count !== count) {\n      this.basketService.changeProductCount(e, count).subscribe(e => {\n        if (e[\"change\"]) {\n          this.basketService.getProducts().subscribe(e => {\n            this.basket = [];\n            this.setBasket(e);\n          });\n        }\n\n        ;\n      });\n    }\n\n    ;\n  }\n\n  roundPrice(price) {\n    const count = Math.round(price * 100) / 100;\n    return isNaN(count) ? 0 : count;\n  }\n\n}\n\nBasketComponent.ɵfac = function BasketComponent_Factory(t) {\n  return new (t || BasketComponent)(i0.ɵɵdirectiveInject(i1.GetProductsService));\n};\n\nBasketComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: BasketComponent,\n  selectors: [[\"app-basket\"]],\n  decls: 7,\n  vars: 3,\n  consts: [[4, \"ngFor\", \"ngForOf\"], [\"routerLink\", \"/zam\\u00F3wienie\", 3, \"disabled\"], [\"min\", \"1\", \"type\", \"number\", 3, \"value\", \"input\"], [\"inpCount\", \"\"], [3, \"click\"]],\n  template: function BasketComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"h2\");\n      i0.ɵɵtext(1, \"Koszyk\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(2, BasketComponent_div_2_Template, 12, 4, \"div\", 0);\n      i0.ɵɵelementStart(3, \"h4\");\n      i0.ɵɵtext(4);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"button\", 1);\n      i0.ɵɵtext(6, \"Przejd\\u017A dalej\");\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngForOf\", ctx.basket);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\"Cena za wszystko: \", ctx.roundPrice(ctx.priceForAll), \"z\\u0142\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", ctx.basketIsEmpty());\n    }\n  },\n  directives: [i2.NgForOf, i3.RouterLink],\n  styles: [\"html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{\\r\\n    height: 100%;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2tldC5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksWUFBWTtBQUNoQiIsImZpbGUiOiJiYXNrZXQuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbImh0bWwsIGJvZHl7XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcbn0iXX0= */\"]\n});","map":{"version":3,"sources":["C:\\Users\\luuuk\\OneDrive\\Pulpit\\angular\\shop\\src\\app\\basket\\basket.component.ts","C:\\Users\\luuuk\\OneDrive\\Pulpit\\angular\\shop\\src\\app\\basket\\basket.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { GetProductsService } from './basket.service';\n\n@Component({\n  selector: 'app-basket',\n  templateUrl: './basket.component.html',\n  styleUrls: ['./basket.component.css']\n})\nexport class BasketComponent implements OnInit {\n\n  price: number = 0;\n  basket = [];\n\n  priceForAll: number = 0;\n\n  constructor(\n    private basketService: GetProductsService\n  ){}\n\n  setBasket(e: [])\n  {\n    this.priceForAll = 0;\n    for(let item of e)\n    {\n      let stuff: {count: number, product: object} = \n      {\n        count: item[\"productCount\"],\n        product: item[\"product\"]\n      };\n\n      this.priceForAll += stuff.count * stuff.product['price'];\n      this.basket.push(stuff);\n    };\n  }\n\n  ngOnInit(): void {\n    this.basketService.getProducts().subscribe((e: []) => {\n      console.log(e)\n      this.setBasket(e);\n    });\n  }\n\n  async deleteFromBasket(e)\n  {\n    const productName = e.product.name;\n    const productType = e.product.type;\n\n    let deleteFun;\n    this.basketService.removeFromBasket(productName, productType).subscribe((e) => {\n\n          if(e[\"delete\"] === true)\n          {\n            this.basketService.getProducts().subscribe((e: [])=> {\n              this.basket = [];\n              this.setBasket(e);\n            });\n          };\n    });\n  }\n\n  changeProductCount(e, count)\n  {\n    if(e.count !== count)\n    {\n      this.basketService.changeProductCount(e, count).subscribe(e => {\n        if(e[\"change\"])\n        {\n          this.basketService.getProducts().subscribe((e: [])=> {\n            this.basket = [];\n            this.setBasket(e);\n          });\n        };\n      });\n    };\n  }\n\n  roundPrice(price: number): number\n  {\n    const count: number = Math.round(price * 100) / 100;\n    return isNaN(count)? 0: count;\n  }\n\n  basketIsEmpty = () => this.basket.length === 0;\n}","<h2>Koszyk</h2>\n<div *ngFor=\"let e of basket\">\n    <div>\n        <p>{{e.product.name}}</p>\n        <input #inpCount min=\"1\" type=\"number\" value=\"{{e.count}}\" (input)=\"changeProductCount(e, inpCount.value)\">\n        <p>Ilość: {{e.stuffCount}}</p>\n        <p>Cena za produkt: {{ roundPrice(e.count * e.product.price) }}zł</p>\n        <button (click)=\"deleteFromBasket(e)\">Usuń</button>\n    </div>\n</div>\n<h4>Cena za wszystko: {{roundPrice(priceForAll)}}zł</h4>\n<button [disabled]=\"basketIsEmpty()\" routerLink=\"/zamówienie\">Przejdź dalej</button>"],"sourceRoot":""},"metadata":{},"sourceType":"module"}